# Бэкенд-часть SPA веб-приложения "Атомарные привычки"

### Установка:

- Убедитесь, что у вас установлен python 3.11 или более новая версия<br>
- Убедитесь, что у вас установлен PostgreSQL и запущен локальный сервер для базы данных<br>
- Убедитесь, что у вас установлен Redis и запущен redis-сервер<br>
- Склонировать репозиторий<br>
- Создать и активировать виртуальное окружение```python -m venv ваша_папка_для_виртуального_окружения```<br>
- Установить зависимости командой ```pip install -r requirements.txt```<br>
- Создать вашу базу данных для работы с проектом ```CREATE DATABASE ваша_база_данных;```<br>
- Создать миграции через ```python3 manage.py makemigrations``` и применить их ```python3 manage.py migrate```<br>
- Открыть командную строку и запустить ```python3 manage.py runserver```<br>
- Для запуска Celery открыть другой экземпляр командной строки и запустить ```celery -A config worker -l INFO```<br>
- Для запуска django-celery-beat открыть другой экземляр командной строки и
  запустить ```celery -A config beat -l INFO```<br>
- Создать бота в телеграм<br>
- В файле .env.sample заполнить данные для работы с проектом и переименовать его в .env<br>

### Используемые технологии:

- DjangoRestFramework<br>
- Swagger/ReDoc ```host://swagger/``` ```host://redoc/```, работает авторизация по Bearer токену<br>
- Redis<br>
- Celery<br>
- CORS<br>
- Сервис рассылок сообщений через Telegram
- Кастомная команда для быстрого создания пользователей ```python3 manage.py ctu```<br>
- Кастомная команда для создания суперпользователя ```python3 manage.py csu```<br>
- Пагинация для вывода списка привычек

### Логика работы системы:

- Зарегистрировать пользователя ```/users/register/```<br>
- Получить токен пользователя ```/users/token/```<br>
- Создать привычку, при этом если это полезная ```is_pleasant=False``` привычка, то необходимо указать также
  вознаграждение ```reward```, либо связанную приятную ```is_pleasant=True``` привычку ```foreign_habit```, а также
  время выполнения привычки и время на выполнение этой привычки<br>
- При этом стоит валидация, по следующим условиям:
  - Одновременный выбор связанной привычки и указание вознаграждения для полезной привычки недопустимо
  - Время на выполнение привычки должно быть не больше 120 секунд
  - В связанные привычки могут попадать только привычки с признаком приятной привычки
  - У приятной привычки не может быть вознаграждения или связанной привычки
  - Нельзя выполнять привычку реже, чем 1 раз в 7 дней<br>
- Если в привычке указать ```is_public=True```, то она будет доступна в списке всех публичных привычек для других
  пользователей<br>
- После создания привычек отрабатывает функция, которая проверяет время, и если до привычки осталось 15 минут -
  отправляет уведомление в Telegram для пользователя<br>
- Необходимо создавать привычку со временем хотя бы за 1 час до её старта, иначе для выполнения она будет доступна на
  следующий день.<br>

### Права доступа:

- Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.<br>
- Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.<br>

### Эндпоинты:
- Регистрация пользователя
- Просмотр деталей профиля
- Редактирование профиля
- Получение токена
- Обновление токена
- Список публичных привычек
- Список своих привычек с пагинацией
- Создание привычки
- Редактирование привычки(через PUT)
- Удаление привычки
